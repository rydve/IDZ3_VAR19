import numpy as np
import scipy.stats as st

# Данные выборки
data = [-10.37, -9.52, -6.71, -6.30, -6.03, -5.95, -5.72, -5.36, -5.25, -5.24,
        -4.05, -4.00, -3.94, -3.63, -3.45, -3.38, -2.78, -2.73, -2.53, -2.16,
        -1.94, -1.75, -1.67, -1.59, -0.30, 0.05, 0.15, 0.34, 0.35, 0.63,
        1.00, 1.82, 2.78, 2.86, 3.26, 3.85, 4.12, 4.63, 4.67, 4.74, 4.90,
        5.04, 5.08, 5.44, 6.37, 6.84, 7.60, 8.13, 9.67, 11.25]

# Размер выборки
n = len(data)

# Вычисляем выборочную несмещенную дисперсию
variance = np.var(data, ddof=1)

# Уровень значимости (дано в условии)
alpha = 0.01  # Соответствует 99% доверительному интервалу

# Квантили хи-квадрат распределения
chi2_lower = st.chi2.ppf(1 - alpha / 2, df=n-1)
chi2_upper = st.chi2.ppf(alpha / 2, df=n-1)

# Границы доверительного интервала
lower_bound = ((n - 1) * variance) / chi2_lower
upper_bound = ((n - 1) * variance) / chi2_upper

# Вывод результатов
print(f"Выборочная дисперсия: {variance:.4f}")
print(f"Квантиль хи-квадрат (нижний): {chi2_lower:.4f}")
print(f"Квантиль хи-квадрат (верхний): {chi2_upper:.4f}")
print(f"Доверительный интервал ({1-alpha:.0%}): [{lower_bound:.4f}, {upper_bound:.4f}]")
